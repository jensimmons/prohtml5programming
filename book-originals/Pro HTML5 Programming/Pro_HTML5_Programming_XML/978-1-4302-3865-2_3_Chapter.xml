<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE Chapter PUBLIC "-//Springer-Verlag//DTD A++ V2.4//EN" "http://devel.springer.de/A++/V2.4/DTD/A++V2.4.dtd">
<Chapter Language="En" OutputMedium="All" ID="Chap3_3">
<ChapterInfo Language="En" ChapterType="OriginalPaper" NumberingStyle="ChapterOnly" TocLevels="0" ContainsESM="No" OutputMedium="All">
<ChapterID>3</ChapterID>
<ChapterNumber>Chapter 3</ChapterNumber>
<ChapterDOI>10.1007/978-1-4302-3865-2_3</ChapterDOI>
<ChapterSequenceNumber>3</ChapterSequenceNumber>
<ChapterTitle Language="En">Scalable Vector Graphics<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary></IndexTerm></ChapterTitle>
<ChapterFirstPage>1</ChapterFirstPage>
<ChapterLastPage>22</ChapterLastPage>
<ChapterCopyright>
<CopyrightHolderName>Peter Lubbers, Brian Albers, and Frank Salim</CopyrightHolderName>
<CopyrightYear>2011</CopyrightYear>
</ChapterCopyright>
<ChapterHistory>
<OnlineDate>
<Year><?InsertOnReleaseOF OFYear?></Year>
<Month><?InsertOnReleaseOF OFMonth?></Month>
<Day><?InsertOnReleaseOF OFDay?></Day>
</OnlineDate>
</ChapterHistory>
</ChapterInfo>
<ChapterHeader>
<AuthorGroup>
<Author AffiliationIDS="Aff1_3" CorrespondingAffiliationID="Aff1_3">
<AuthorName>
<GivenName>Peter</GivenName>
<FamilyName>Lubbers</FamilyName>
</AuthorName>
</Author>
<Author AffiliationIDS="Aff1_3">
<AuthorName>
<GivenName>Brian</GivenName>
<FamilyName>Albers</FamilyName>
</AuthorName>
</Author>
<Author AffiliationIDS="Aff1_3">
<AuthorName>
<GivenName>Frank</GivenName>
<FamilyName>Salim</FamilyName>
</AuthorName>
</Author>
<Affiliation ID="Aff1_3">
<OrgName>Technical Communication at Kaazing</OrgName>
<OrgAddress>
<City>San Francisco</City>
<State>CA</State>
<Country>USA</Country>
</OrgAddress>
</Affiliation>
</AuthorGroup>
<Abstract Language="En" OutputMedium="Online" ID="Abs1_3">
<Heading>Abstract</Heading>
<Para>In this chapter, we&#x2019;ll explore what you can do with another graphics feature in HTML5: <Emphasis Type="Italic">Scalable Vector Graphics</Emphasis>. Scalable Vector Graphics, or SVG, is an expressive language for two dimensional graphics.</Para>
</Abstract>
</ChapterHeader>
<Body>
<Para>In this chapter, we&#x2019;ll explore what you can do with another graphics feature in HTML5: <Emphasis Type="Italic">Scalable Vector Graphics</Emphasis>. Scalable Vector Graphics, or SVG, is an expressive language for two dimensional graphics.</Para>
<Section1 ID="Sec2_3">
<Heading>Overview of SVG</Heading>
<Para>In this section we&#x2019;ll look at the standard vector graphics support in HTML5 browsers, but first, let&#x2019;s review a couple of graphics concepts: raster and vector graphics.</Para>
<Para>In raster graphics, an image is represented by a two dimensional grid of pixels. The HTML5 Canvas 2d API is an example of a raster graphics API. Drawing with the Canvas API updates the canvas&#x2019;s pixels. PNG and JPEG are examples of raster image formats. The data in PNG and JPEG images also represents pixels.</Para>
<Para>Vector graphics are quite different. Vector graphics represent images with mathematical descriptions of geometry. A vector image contains all of the information needed to draw an image from high-level geometric objects such as lines and shapes. As you can tell by the name, SVG is an example of vector graphics. Like HTML, SVG is a file format that also has an API. SVG combined with the DOM APIs form a vector graphics API. It is possible to embed raster graphics such as PNG images inside of SVG, but SVG is primarily a vector format.</Para>
<Section2 ID="Sec3_3">
<Heading>History</Heading>
<Para>SVG has been around for a few years. SVG 1.0 was published as a W3C recommendation in 2001. SVG was originally available in browsers with the use of a plugin. Shortly afterward, browsers added native support for SVG images.</Para>
<Para>Inline SVG in HTML has a shorter<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>history</Secondary></IndexTerm> history. A defining characteristic of SVG is that it is based on XML. HTML, of course, has a different syntax, and you cannot simply embed XML syntax inside of HTML documents. Instead, it has special rules for SVG. Prior to HTML5, it was possible to embed SVG as &#x003C;img&#x003E; elements inside an HTML page or link to self-contained .svg documents. HTML5 introduced inline SVG, in which SVG elements themselves can appear in HTML markup. Of course, in HTML, the syntax rules are more relaxed than in XML. You can have unquoted attributes, mixed capitalization, and so on. You will still need to use self-closing tags when appropriate. For example, you can embed a circle into your HTML document with just a little markup:</Para>
<Para Type="Programcode">&#x003C;svg height=100 width=100&#x003E;&#x003C;circle cx=50 cy=50 r=50 /&#x003E;&#x003C;/svg&#x003E;</Para>
</Section2>
<Section2 ID="Sec4_3">
<Heading>Understanding SVG</Heading>
<Para>Figure <InternalRef RefID="Fig1_3">3-1</InternalRef> shows an HTML5 document with the<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary><Emphasis Type="Italic">Happy Trails!</Emphasis></Secondary></IndexTerm> <Emphasis Type="Italic">Happy Trails!</Emphasis> image we drew with the canvas API in <ExternalRef>
<RefSource>Chapter 2</RefSource>
<RefTarget TargetType="DOI" Address="10.1007/978-1-4302-3865-2_2"/>
</ExternalRef>. If you read the title of this chapter, you can probably guess that this version was drawn with SVG. SVG lets you do many of the same drawing operations as the canvas API. Much of the time, the results can be visually identical. There are some important invisible differences, however. For one thing, the text is selectable. You don&#x2019;t get that with canvas! When you draw text onto a canvas element, the characters are frozen as pixels. They become part of the image and cannot change unless you redraw a region of the canvas. Because of that, text drawn onto a canvas is invisible to search engines. SVG, on the other hand, is searchable. Google, for instance, indexes the text in SVG content on the web.<Figure ID="Fig1_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-1</CaptionNumber>
<CaptionContent>
<SimplePara>SVG version of Happy Trails!<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>Happy Trails!</Secondary></IndexTerm>
</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO1_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig1_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<Para>SVG is closely related to HTML. If you choose, you can define the content of an SVG <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>markup document</Secondary></IndexTerm>document with markup. HTML is a declarative language for structuring pages. SVG is a complimentary language for creating visual structures. You can interact with both SVG and HTML using DOM APIs. SVG documents are live trees of elements that you can script and style, just like HTML. You can attach event handlers to SVG elements. For example, you can use click event handlers to make SVG buttons or shaped clickable regions. That is essential for building interactive applications that use mouse input.</Para>
<Para>Additionally, you can view and edit the structure of the SVG in <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>elements, ChromeWeb Inspector</Secondary></IndexTerm>your browser&#x2019;s development tool. As you can see in Figure <InternalRef RefID="Fig2_3">3-2</InternalRef>, inline SVG embeds directly into the HTML DOM. It has a structure you can observe and change at runtime. You can dig into SVG and see its source, unlike an image that is just a grid of pixels.
<Figure ID="Fig2_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-2</CaptionNumber>
<CaptionContent>
<SimplePara>Looking at the SVG elements in ChromeWeb Inspector<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>elements, ChromeWeb Inspector</Secondary></IndexTerm>
</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO2_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig2_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<Para>In Figure <InternalRef RefID="Fig2_3">3-2</InternalRef>, the highlighted text element contains the following code:</Para>
<Para Type="Programcode">&#x003C; text y="60" x="200" font-family="impact" font-size="60px"</Para>
<Para Type="Programcode">fill="#996600" text-anchor="middle"&#x003E;</Para>
<Para Type="Programcode">Happy Trails</Para>
<Para Type="Programcode">&#x003C;/text&#x003E;</Para>
<Para>In the development environment you can add, remove, and edit SVG elements. The changes take effect instantly in the active page. This is extremely convenient for debugging and experimenting.</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Retained-Mode Graphics</Heading>
<Para><Emphasis Type="Bold">Frank says</Emphasis>: &#x201C;There are two schools of thought in graphics API design. Immediate-mode graphics like canvas provide a drawing interface. API calls cause a drawing action to occur <Emphasis Type="Italic">immediately</Emphasis>, hence the name. The counter style to immediate mode-graphics is called retained-mode. In retained-mode graphics, there is a model of the visual objects in the scene that is retained over time. There is an API to manipulate the scene graph, and the graphics engine redraws the scene when it changes. SVG is retained-mode graphics in which its scene graph is the document. The API to manipulate SVG is the W3C DOM API.</Para>
<Para>There are JavaScript libraries that build-retained mode APIs on top of canvas. Some also provide sprites, input handling, and layers. You may choose to use such a library, but remember that these features and more are native in SVG!&#x201D;</Para>
</FormalPara>
</Section2>
<Section2 ID="Sec5_3">
<Heading>Scalable Graphics</Heading>
<Para>When you magnify, rotate, or otherwise transform SVG content, all of the lines making up the image are crisply redrawn. SVG scales without losing quality. The vector information that makes up an SVG document is preserved when it is rendered. Contrast that with pixel graphics. If you magnify a pixel graphic like a canvas or an image, it becomes blurry. That is because the image is composed of pixels that can only be resampled at a higher resolution. The underlying information&#x2014;the<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>closeup images</Secondary></IndexTerm> paths and shapes that went into making the image&#x2014;is lost after drawing (see Figure <InternalRef RefID="Fig3_3">3-3</InternalRef>).
<Figure ID="Fig3_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-3</CaptionNumber>
<CaptionContent>
<SimplePara>Closeups of SVG and canvas at 500% magnification</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO3_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig3_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
</Section2>
<Section2 ID="Sec6_3">
<Heading>Creating 2D Graphics<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>2D graphics creation</Secondary></IndexTerm> with SVG</Heading>
<Para>Let&#x2019;s look again at the <Emphasis Type="Italic">Happy Trails!</Emphasis> image from Figure <InternalRef RefID="Fig1_3">3-1</InternalRef>.Every visible part of this SVG drawing has some corresponding markup. The complete SVG language is quite extensive, and all of its details and nuances will not fit in this chapter. However, to get a glimpse of the breadth of the SVG vocabulary, here are some of the features used to draw Happy Trails:<UnorderedList Mark="Bullet">
<ItemContent><Para>Shapes</Para></ItemContent>
<ItemContent><Para>Paths</Para></ItemContent>
<ItemContent><Para>Transformations</Para></ItemContent>
<ItemContent><Para>Patterns and Gradients</Para></ItemContent>
<ItemContent><Para>Reusable Content</Para></ItemContent>
<ItemContent><Para>Text</Para></ItemContent>
</UnorderedList>
</Para>
<Para>Let&#x2019;s look at each of these in turn before we combine them into a complete scene. Before we can do that, though, we&#x2019;ll need to see how to add SVG to a page.</Para>
</Section2>
<Section2 ID="Sec7_3">
<Heading>Adding SVG to a Page</Heading>
<Para>Adding inline SVG to an HTML page is as simple <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>addition, page</Secondary></IndexTerm>as adding any other element.</Para>
<Para>There are several ways to use SVG on the Web, including as &#x003C;img&#x003E; elements. We will use inline SVG in HTML, because it will integrate into the HTML document. That will let us later write an interactive application that seamlessly combines HTML, JavaScript, and SVG (see Listing 3-1).</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-1.</Heading>
<Para>SVG Containing a Red Rectangle</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;!doctype html&#x003E;</Para>
<Para Type="Programcode">&#x003C;svg width="200" height="200"&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
<Para>That&#x2019;s it! No XML namespace necessary. Now, between the start and end svg tags, we can add shapes and other visual objects. If you want to split the SVG content out into a separate .svg file, you will need to change it like so:</Para>
<Para Type="Programcode">&#x003C;svg width="400" height="600" xmlns="http://www.w3.org/2000/svg"</Para>
<Para Type="Programcode">    xmlns:xlink="http://www.w3.org/1999/xlink"&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
<Para>Now it is a valid XML document with the proper namespace attributes. You will be able to open that document with a wide variety of image viewers and editors. You can also refer to an SVG file from HTML as a static image with code such as <Literal>&#x003C;img src="example.svg"&#x003E;</Literal>. One downside to that approach is that the SVG document is not integrated into the DOM the way inline SVG content is. You won&#x2019;t be able to script interaction with the SVG elements.</Para>
</Section2>
<Section2 ID="Sec8_3">
<Heading>Simple Shapes</Heading>
<Para>The SVG language includes<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>basic shapes</Secondary></IndexTerm> basic shape elements such as rectangles, circles, and ellipses. The size and position of shape elements are defined with attributes. For rectangles, these are <Literal>width</Literal> and <Literal>height</Literal>. For circles, there is an <Literal>r</Literal> attribute for radius. All of these use the CSS syntax for distances, so they can be pixels, points, ems, and so on. Listing 3-2 is a very short HTML document containing inline SVG. It is just a gray rectangle with a red outline that is 100 pixels by 80 pixels in size, and it is displayed in Figure <InternalRef RefID="Fig4_3">3-4</InternalRef>.
<Figure ID="Fig4_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-4</CaptionNumber>
<CaptionContent>
<SimplePara>An SVG rectangle in an HTML document</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO4_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig4_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-2.</Heading>
<Para>SVG Containing a Red Rectangle</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;!doctype html&#x003E;</Para>
<Para Type="Programcode">&#x003C;svg width="200" height="200"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;rect x="10" y="20" width="100" height="80" stroke="red" fill="#ccc" /&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
<Para>SVG draws objects in the order they appear in the document. If we add a circle after the rectangle, it appears on top of the first shape. We will give that circle an 8 pixel wide blue stroke and no fill style (see Listing 3-3), so it stands out, as shown in Figure <InternalRef RefID="Fig5_3">3-5</InternalRef>.
<Figure ID="Fig5_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-5</CaptionNumber>
<CaptionContent>
<SimplePara>A rectangle and a circle</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO5_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig5_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-3.</Heading>
<Para>A Rectangle and a Circle</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;!doctype html&#x003E;</Para>
<Para Type="Programcode">&#x003C;svg width="200" height="200"&#x003E;</Para>
<Para Type="Programcode">&#x003C;rect x="10" y="20" width="100" height="80" stroke="red" fill="#ccc" /&#x003E;</Para>
<Para Type="Programcode">&#x003C;circle cx="120" cy="80" r="40" stroke="#00f" fill="none" stroke-width="8" /&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
<Para>Note that the x and y attributes define<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>basic shapes</Secondary></IndexTerm> the position of the top-left corner of the rectangle. The circle, on the other hand, has cx and cy attributes, which are the x and y values for the center of the circle. SVG uses the same coordinate system as the canvas API. The top-left corner of the svg element is position 0,0. See <ExternalRef>
<RefSource>Chapter 2</RefSource>
<RefTarget TargetType="DOI" Address="10.1007/978-1-4302-3865-2_2"/>
</ExternalRef> for the details of the canvas coordinate system.</Para>
</Section2>
<Section2 ID="Sec9_3">
<Heading>Transforming SVG Elements</Heading>
<Para>There are organizational elements in SVG intended to combine<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>elements transformation</Secondary></IndexTerm> multiple elements so that they can be transformed or linked to as units. The g element stands for group. Groups can be used to combine multiple related elements. As a group, they can be referred to by a common ID. A group can also be transformed as a unit. If you add a transform attribute to a group, all of that group&#x2019;s contents are transformed. The transform attribute can include commands to rotate (see Listing 3-4 and Figure <InternalRef RefID="Fig6_3">3-6</InternalRef>), translate, scale, and skew. You can also specify a transformation matrix, just as you can with the canvas API.<Figure ID="Fig6_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-6</CaptionNumber>
<CaptionContent>
<SimplePara>A rotated group<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>elements transformation</Secondary></IndexTerm>
</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO6_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig6_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure>
</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-4.</Heading>
<Para>A Rectangle and a Circle Within a Rotated Group</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;svg width="200" height="200"&#x003E;</Para>
<Para Type="Programcode">    &#x003C;g transform="translate(60,0) rotate(30) scale(0.75)" id="ShapeGroup"&#x003E;</Para>
<Para Type="Programcode">      &#x003C;rect x="10" y="20" width="100" height="80" stroke="red" fill="#ccc" /&#x003E;</Para>
<Para Type="Programcode">      &#x003C;circle cx="120" cy="80" r="40" stroke="#00f" fill="none" stroke-</Para>
<Para Type="Programcode">width="8" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
</Section2>
<Section2 ID="Sec10_3">
<Heading>Reusing Content</Heading>
<Para>SVG has a defs element for <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>content definition</Secondary></IndexTerm>defining content for future use. It also has an element named &#x201C;use&#x201D; that you can link to your definitions. This lets you reuse the same content multiple times and eliminate redundancy. Figure <InternalRef RefID="Fig7_3">3-7</InternalRef> shows a group used three times at different transformed positions and scales. The group has the id &#x201C;ShapeGroup,&#x201D; and it contains a rectangle and a circle. The actual rectangle and circle shapes are just defined the one time inside of the defs element. The defined group is not, by itself, visible. Instead, there are three use elements linked to the shape group, so three rectangles and three circles appear rendered on the page (see Listing 3-5).<Figure ID="Fig7_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-7</CaptionNumber>
<CaptionContent>
<SimplePara>Three use elements referencing the same group</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO7_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig7_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure>
</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-5.</Heading>
<Para>Using a Group Three Times</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;svg width="200" height="200"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;defs&#x003E;</Para>
<Para Type="Programcode">    &#x003C;g id="ShapeGroup"&#x003E;</Para>
<Para Type="Programcode">      &#x003C;rect x="10" y="20" width="100" height="80" stroke="red" fill="#ccc" /&#x003E;</Para>
<Para Type="Programcode">      &#x003C;circle cx="120" cy="80" r="40" stroke="#00f" fill="none" stroke-</Para>
<Para Type="Programcode">width="8" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/defs&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#ShapeGroup" transform="translate(60,0) scale(0.5)"/&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#ShapeGroup" transform="translate(120,80) scale(0.4)"/&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#ShapeGroup" transform="translate(20,60) scale(0.25)"/&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
</Section2>
<Section2 ID="Sec11_3">
<Heading>Patterns and Gradients</Heading>
<Para>The circle and rectangle<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>patterns and gradients</Secondary></IndexTerm> in Figure <InternalRef RefID="Fig7_3">3-7</InternalRef> have simple fill and stroke styles. Objects can be painted with more complex styles, including gradients and patterns (see Listing 3-6). Gradients can be linear or radial. Patterns can be made up of pixel graphics or even other SVG elements. Figure <InternalRef RefID="Fig8_3">3-8</InternalRef> shows a rectangle with a linear color gradient as well as a circle with a gravel texture. The texture comes from a JPEG image that is linked to from an SVG image element.<Figure ID="Fig8_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-8</CaptionNumber>
<CaptionContent>
<SimplePara>A rectangle with a gradient fill and a circle with a pattern fill</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO8_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig8_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-6.</Heading>
<Para>Texturing the Rectangle and Circle</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;!doctype html&#x003E;</Para>
<Para Type="Programcode">&#x003C;svg width="200" height="200"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;defs&#x003E;</Para>
<Para Type="Programcode">    &#x003C;pattern id="GravelPattern" patternUnits="userSpaceOnUse"</Para>
<Para Type="Programcode">          x="0" y="0" width="100" height="67" viewBox="0 0 100 67"&#x003E;</Para>
<Para Type="Programcode">      &#x003C;image x="0" y="0" width="100" height="67"</Para>
<Para Type="Programcode">xlink:href="gravel.jpg"&#x003E;&#x003C;/image&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/pattern&#x003E;</Para>
<Para Type="Programcode">    &#x003C;linearGradient id="RedBlackGradient"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="0%" stop-color="#000"&#x003E;&#x003C;/stop&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="100%" stop-color="#f00"&#x003E;&#x003C;/stop&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/linearGradient&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/defs&#x003E;</Para>
<Para Type="Programcode">  &#x003C;rect x="10" y="20" width="100" height="80"</Para>
<Para Type="Programcode">      stroke="red"</Para>
<Para Type="Programcode">      fill="url(#RedBlackGradient)" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;circle cx="120" cy="80" r="40" stroke="#00f"</Para>
<Para Type="Programcode">      stroke-width="8"</Para>
<Para Type="Programcode">      fill="url(#GravelPattern)" /&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
</Section2>
<Section2 ID="Sec12_3">
<Heading>SVG Paths<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>paths</Secondary></IndexTerm></Heading>
<Para>SVG has freeform paths as well as simple shapes. Path elements have d attributes. The d stands for data. Inside the value of the d attribute, you can specify a series of path drawing commands. Each command might take coordinate arguments. Some of the commands are M for moveto, L for lineto, Q for quadratic curve, and Z for closing the path. If these remind you of the canvas drawing API, that is no coincidence. Listing 3-7 uses a path element to draw a closed tree canopy shape using a series of lineto commands.</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-7.</Heading>
<Para>SVG <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>paths</Secondary></IndexTerm>Path Defining a Tree Canopy<IndexTerm><Primary>Tree Canopy</Primary></IndexTerm></Para>
</FormalPara>
<Para Type="Programcode">&#x003C;path d="M-25, -50</Para>
<Para Type="Programcode">            L-10, -80</Para>
<Para Type="Programcode">            L-20, -80</Para>
<Para Type="Programcode">            L-5, -110</Para>
<Para Type="Programcode">            L-15, -110</Para>
<Para Type="Programcode">            L0, -140</Para>
<Para Type="Programcode">            L15, -110</Para>
<Para Type="Programcode">            L5, -110</Para>
<Para Type="Programcode">            L20, -80</Para>
<Para Type="Programcode">            L10, -80</Para>
<Para Type="Programcode">            L25, -50</Para>
<Para Type="Programcode">            Z" id="Canopy"&#x003E;&#x003C;/path&#x003E;</Para>
<Para>You can fill a path by closing it with the Z command and giving it a fill attribute, just like the rectangle we drew earlier. Figure <InternalRef RefID="Fig9_3">3-9</InternalRef> shows how to draw a tree by combining a stroked closed path and a filled closed path.<Figure ID="Fig9_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-9</CaptionNumber>
<CaptionContent>
<SimplePara>A stroked path, a filled path, and both paths</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO9_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig9_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<Para>Similarly, we can create an open path with two quadratic curves to form a trail. We can even give it texture. Note the <Literal>stroke-linejoin</Literal> attribute in Listing 3-8. This makes a round connection between the two quadratic curves. Figure <InternalRef RefID="Fig10_3">3-10</InternalRef> shows a mountain trail drawn as an open path.<Figure ID="Fig10_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-10</CaptionNumber>
<CaptionContent>
<SimplePara>An open path containing two quadratic curves<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>paths</Secondary></IndexTerm>
</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO10_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig10_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-8.</Heading>
<Para>SVG Path Defining a Twisting Trail</Para>
</FormalPara>
<Para Type="Programcode">  &#x003C;g transform="translate(-10, 350)" stroke-width="20" stroke="url(#GravelPattern)" stroke-linejoin="round"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;path d="M0,0 Q170,-50 260, -190 Q310, -250 410,-250" fill="none"&#x003E;&#x003C;/path&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/g&#x003E;</Para>
</Section2>
<Section2 ID="Sec13_3">
<Heading>Using SVG Text</Heading>
<Para>SVG also supports text. Text in SVG is selectable within the browser (see Figure <InternalRef RefID="Fig11_3">3-11</InternalRef>). Should they choose to, browsers and search engines could also allow users to search for text inside of SVG text elements. This has major usability and accessibility benefits.<Figure ID="Fig11_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-11</CaptionNumber>
<CaptionContent>
<SimplePara>Selecting SVG text</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO11_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig11_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
<Para>SVG Text<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>text selection</Secondary></IndexTerm> has attributes that are similar to CSS style rules for HTML. Listing 3-9 shows a text element that has font-weight and font-family attributes. As in CSS, font-family can be a single font-family name like &#x201C;sans-serif&#x201D; or a list of fallbacks like &#x201C;Droid Sans, sans-serif&#x201D; in the order you prefer.</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-9.</Heading>
<Para>SVG Text</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;svg width="600" height="200"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;text</Para>
<Para Type="Programcode">    x="10" y="80"</Para>
<Para Type="Programcode">    font-family="Droid Sans"</Para>
<Para Type="Programcode">    stroke="#00f"</Para>
<Para Type="Programcode">    fill="#0ff"</Para>
<Para Type="Programcode">    font-size="40px"</Para>
<Para Type="Programcode">    font-weight="bold"&#x003E;</Para>
<Para Type="Programcode">    Select this text!</Para>
<Para Type="Programcode">  &#x003C;/text&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
</Section2>
<Section2 ID="Sec14_3">
<Heading>Putting the Scene Together</Heading>
<Para>We can combine all of the preceding elements to make an image of happy trails. The text is, naturally, a text element. The tree trunks are composed of two rectangles. The tree canopies are two paths. The trees cast shadows, which use the same geometry given a gray fill color and a transformation that skews them down and to the right. The winding path that cuts across the image is another path with an image pattern for texture. There is also a little bit of CSS to give the scene an outline.</Para>
<Para>Listing 3-10 provides the complete code for<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>trails-static.html</Secondary></IndexTerm> <Literal>trails-static.html</Literal>.</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-10.</Heading>
<Para>Complete Code for <Literal>trails-static.html</Literal></Para>
</FormalPara>
<Para Type="Programcode">&#x003C;title&#x003E;Happy Trails in SVG&#x003C;/title&#x003E;</Para>
<Para Type="Programcode">&#x003C;style&#x003E;</Para>
<Para Type="Programcode">  svg {</Para>
<Para Type="Programcode">        border: 1px solid black;</Para>
<Para Type="Programcode">  }</Para>
<Para Type="Programcode">&#x003C;/style&#x003E;</Para>
<Para Type="Programcode">&#x003C;svg width="400" height="600"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;defs&#x003E;</Para>
<Para Type="Programcode">        &#x003C;pattern id="GravelPattern" patternUnits="userSpaceOnUse" x="0" y="0" width="100" height="67" viewBox="0 0 100 67"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;image x=0 y=0 width=100 height=67 xlink:href="gravel.jpg" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;/pattern&#x003E;</Para>
<Para Type="Programcode">        &#x003C;linearGradient id="TrunkGradient"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="0%" stop-color="#663300" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="40%" stop-color="#996600" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="100%" stop-color="#552200" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;/linearGradient&#x003E;</Para>
<Para Type="Programcode">        &#x003C;rect x="-5" y="-50" width=10 height=50 id="Trunk" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;path d="M-25, -50</Para>
<Para Type="Programcode">                L-10, -80</Para>
<Para Type="Programcode">                L-20, -80</Para>
<Para Type="Programcode">                L-5, -110</Para>
<Para Type="Programcode">                L-15, -110</Para>
<Para Type="Programcode">                L0, -140</Para>
<Para Type="Programcode">                L15, -110</Para>
<Para Type="Programcode">                L5, -110</Para>
<Para Type="Programcode">                L20, -80</Para>
<Para Type="Programcode">                L10, -80</Para>
<Para Type="Programcode">                L25, -50</Para>
<Para Type="Programcode">                Z"</Para>
<Para Type="Programcode">        id="Canopy"</Para>
<Para Type="Programcode">        /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;linearGradient id="CanopyShadow" x=0 y=0 x2=0 y2=100%&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="0%" stop-color="#000" stop-opacity=".5" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="20%" stop-color="#000" stop-opacity="0" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;/linearGradient&#x003E;</Para>
<Para Type="Programcode">        &#x003C;g id="Tree"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;use xlink:href="#Trunk" fill="url(#TrunkGradient)" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;use xlink:href="#Trunk" fill="url(#CanopyShadow)" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;use xlink:href="#Canopy" fill="none" stroke="#663300"</Para>
<Para Type="Programcode">        stroke-linejoin="round" stroke-width="4px" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;use xlink:href="#Canopy" fill="#339900" stroke="none" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">        &#x003C;g id="TreeShadow"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;use xlink:href="#Trunk" fill="#000" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;use xlink:href="#Canopy" fill="000" stroke="none" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/defs&#x003E;</Para>
<Para Type="Programcode">  &#x003C;g transform="translate(-10, 350)"<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>trails-static.html</Secondary></IndexTerm>
</Para>
<Para Type="Programcode">        stroke-width="20"</Para>
<Para Type="Programcode">        stroke="url(#GravelPattern)"</Para>
<Para Type="Programcode">        stroke-linejoin="round"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;path d="M0,0 Q170,-50 260, -190 Q310, -250 410,-250"</Para>
<Para Type="Programcode">        fill="none" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">  &#x003C;text y=60 x=200</Para>
<Para Type="Programcode">        font-family="impact"</Para>
<Para Type="Programcode">        font-size="60px"</Para>
<Para Type="Programcode">        fill="#996600"</Para>
<Para Type="Programcode">        text-anchor="middle" &#x003E;</Para>
<Para Type="Programcode">        Happy Trails!</Para>
<Para Type="Programcode">  &#x003C;/text&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#TreeShadow"</Para>
<Para Type="Programcode">        transform="translate(130, 250) scale(1, .6) skewX(-18)"</Para>
<Para Type="Programcode">        opacity="0.4" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#Tree" transform="translate(130,250)" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#TreeShadow"</Para>
<Para Type="Programcode">        transform="translate(260, 500) scale(2, 1.2) skewX(-18)"</Para>
<Para Type="Programcode">        opacity="0.4" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#Tree" transform="translate(260, 500) scale(2)" /&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
</Section2>
</Section1>
<Section1 ID="Sec15_3">
<Heading>Building an <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary></IndexTerm>Interactive Application with SVG</Heading>
<Para>In this section, we&#x2019;ll expand on the static example. We will add HTML and JavaScript to make the document interactive. We will take advantage of the capabilities of SVG in an application that would require considerably more code to implement with the canvas API.</Para>
<Section2 ID="Sec16_3">
<Heading>Adding Trees<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>AddTree function</Tertiary></IndexTerm></Heading>
<Para>We need just a single button element in this interactive application. The click handler for the button adds a new tree at a random location within the 600x400 pixel SVG region. The new tree is also randomly scaled by an amount between 50% and 150%. Each new tree is actually a use element referencing the &#x201C;Tree&#x201D; group containing multiple paths. The code uses the namespaced <Literal>document.createElementNS()</Literal> call to create a <Literal>use</Literal> element. It links it with the <Literal>xlink:href</Literal> attribute to the previously defined Tree group. It then appends the new element to the SVG element tree (see Listing 3-11).</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-11.</Heading>
<Para>Add Tree Function</Para>
</FormalPara>
<Para Type="Programcode">  document.getElementById("AddTreeButton").onclick = function() {</Para>
<Para Type="Programcode">    var x = Math.floor(Math.random() * 400);</Para>
<Para Type="Programcode">    var y = Math.floor(Math.random() * 600);</Para>
<Para Type="Programcode">    var scale = Math.random() + .5;</Para>
<Para Type="Programcode">    var translate = "translate(" + x + "," + y + ") ";</Para>
<Para Type="Programcode">    var tree = document.createElementNS("http://www.w3.org/2000/svg", "use");</Para>
<Para Type="Programcode">    tree.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", "#Tree");</Para>
<Para Type="Programcode">    tree.setAttribute("transform", translate + "scale(" + scale + ")");</Para>
<Para Type="Programcode">    document.querySelector("svg").appendChild(tree);</Para>
<Para Type="Programcode">    updateTrees();</Para>
<Para Type="Programcode">  }</Para>
<Para>Elements are rendered in the order they appear in the DOM. This function always adds trees as new child nodes at the end of the SVG element&#x2019;s list of child nodes. That means that newer trees will appear on top of older trees.</Para>
<Para>This function ends with a call to <Literal>updateTrees()</Literal>, which we will see next.</Para>
</Section2>
<Section2 ID="Sec25_3">
<Heading>Adding the updateTrees Function</Heading>
<Para>The <Literal>updateTrees</Literal> function<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>updateTrees function</Tertiary></IndexTerm> runs when the document initially loads as well as any time trees are added or removed. It is responsible for updating the text that displays the number of trees in the forest. It also attaches a click handler function to each tree (see Listing 3-12).</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-12</Heading>
<Para>updateTrees Function</Para>
</FormalPara>
<Para Type="Programcode">  function updateTrees() {</Para>
<Para Type="Programcode">    var list = document.querySelectorAll("use");</Para>
<Para Type="Programcode">    var treeCount = 0;</Para>
<Para Type="Programcode">    for (var i=0; i&#x003C;list.length; i++) {</Para>
<Para Type="Programcode">      if(list[i].getAttribute("xlink:href")=="#Tree") {</Para>
<Para Type="Programcode">        treeCount++;</Para>
<Para Type="Programcode">        list[i].onclick = removeTree;</Para>
<Para Type="Programcode">      }</Para>
<Para Type="Programcode">    }</Para>
<Para Type="Programcode">    var counter = document.getElementById("TreeCounter");</Para>
<Para Type="Programcode">    counter.textContent = treeCount + " trees in the forest";</Para>
<Para Type="Programcode">  }</Para>
<Para>An important<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>updateTrees function</Tertiary></IndexTerm> thing to note about this code is that it keeps no state in JavaScript regarding the tree count. Every time an update occurs, this code selects and filters all of the trees from the live document to get the latest count.</Para>
</Section2>
<Section2 ID="Sec26_3">
<Heading>Adding the removeTree Function</Heading>
<Para>Now, let&#x2019;s add the function that removes trees when they are clicked (see Listing 3-13).</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-13.</Heading>
<Para>removeTree Function<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>removeTree function</Tertiary></IndexTerm>
</Para>
</FormalPara>
<Para Type="Programcode">  function removeTree(e) {</Para>
<Para Type="Programcode">    var elt = e.target;</Para>
<Para Type="Programcode">    if (elt.correspondingUseElement) {</Para>
<Para Type="Programcode">      elt = elt.correspondingUseElement;</Para>
<Para Type="Programcode">    }</Para>
<Para Type="Programcode">    elt.parentNode.removeChild(elt);</Para>
<Para Type="Programcode">    updateTrees();</Para>
<Para Type="Programcode">  }</Para>
<Para>The first thing we do here is check the target of the click event. Due to differences in DOM implementations, the event target could be either the tree group or a use element linked to that group. Either way, this function simply removes that element from the DOM and calls the <Literal>updateTrees()</Literal> function.</Para>
<Para>If you remove a tree that is on top of another tree, you don&#x2019;t have to do anything to redraw the lower content. This is one of the benefits of developing against a retained-mode API. You simply manipulate the tree (no pun intended) of elements, and the browser takes care of drawing the necessary pixels. Similarly, when the text updates to display the latest tree count, it stays below the trees. If you want the text to appear above the trees, you will have to append the trees to the document before the text element.</Para>
</Section2>
<Section2 ID="Sec17_3">
<Heading>Adding the<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>CSS style</Tertiary></IndexTerm> CSS Styles</Heading>
<Para>To make the interaction more discoverable, we will add some CSS that changes the appearance of the tree beneath the mouse cursor:</Para>
<Para Type="Programcode">g[id=Tree]:hover {</Para>
<Para Type="Programcode">        opacity: 0.9;</Para>
<Para Type="Programcode">        cursor: crosshair;</Para>
<Para Type="Programcode">  }</Para>
<Para>Whenever you hover over an element with an id attribute equal to &#x201C;Tree,&#x201D; that element will become partially transparent, and the mouse cursor will change to a crosshair.</Para>
<Para>The one pixel black border around the entire SVG element is also defined in CSS.<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>CSS style</Tertiary></IndexTerm>
</Para>
<Para Type="Programcode">  svg {</Para>
<Para Type="Programcode">    border: 1px solid black;</Para>
<Para Type="Programcode">  }</Para>
<Para>And that&#x2019;s it! Now you have an interactive application using inline SVG in HTML5 (see Figure <InternalRef RefID="Fig12_3">3-12</InternalRef>).<Figure ID="Fig12_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-12</CaptionNumber>
<CaptionContent>
<SimplePara>The final document with a few trees added<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>CSS style</Tertiary></IndexTerm>
</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO12_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig12_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure></Para>
</Section2>
<Section2 ID="Sec111_3">
<Heading>The Final Code</Heading>
<Para>For completeness, Listing 3-14 provides the entire<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>trails-dynamic.html code</Tertiary></IndexTerm> <Literal>trails-dynamic.html</Literal> file. It contains all of the SVG from the static version as well as the script that makes it interactive.</Para>
<FormalPara RenderingStyle="Style1">
<Heading>Listing 3-14.</Heading>
<Para>The Entire <Literal>trails-dynamic.html</Literal> Code</Para>
</FormalPara>
<Para Type="Programcode">&#x003C;!doctype html&#x003E;</Para>
<Para Type="Programcode">&#x003C;title&#x003E;Happy Trails in SVG&#x003C;/title&#x003E;</Para>
<Para Type="Programcode">&#x003C;style&#x003E;</Para>
<Para Type="Programcode">  svg {</Para>
<Para Type="Programcode">    border: 1px solid black;</Para>
<Para Type="Programcode">  }</Para>
<Para Type="Programcode">  g[id=Tree]:hover {</Para>
<Para Type="Programcode">    opacity: 0.9;</Para>
<Para Type="Programcode">    cursor: crosshair;</Para>
<Para Type="Programcode">  }</Para>
<Para Type="Programcode">&#x003C;/style&#x003E;</Para>
<Para Type="Programcode">&#x003C;div&#x003E;</Para>
<Para Type="Programcode">  &#x003C;button id="AddTreeButton"&#x003E;Add Tree&#x003C;/button&#x003E;</Para>
<Para Type="Programcode">&#x003C;/div&#x003E;</Para>
<Para Type="Programcode">&#x003C;svg width="400" height="600"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;defs&#x003E;</Para>
<Para Type="Programcode">    &#x003C;pattern id="GravelPattern" patternUnits="userSpaceOnUse" x="0" y="0" width="100" height="67" viewBox="0 0 100 67"&#x003E;</Para>
<Para Type="Programcode">      &#x003C;image x=0 y=0 width=100 height=67 xlink:href="gravel.jpg" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/pattern&#x003E;</Para>
<Para Type="Programcode">    &#x003C;linearGradient id="TrunkGradient"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="0%" stop-color="#663300" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="40%" stop-color="#996600" /&#x003E;<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>trails-dynamic.html code</Tertiary></IndexTerm>
</Para>
<Para Type="Programcode">        &#x003C;stop offset="100%" stop-color="#552200" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/linearGradient&#x003E;</Para>
<Para Type="Programcode">    &#x003C;rect x="-5" y="-50" width=10 height=50 id="Trunk" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;path d="M-25, -50</Para>
<Para Type="Programcode">            L-10, -80</Para>
<Para Type="Programcode">            L-20, -80</Para>
<Para Type="Programcode">            L-5, -110</Para>
<Para Type="Programcode">            L-15, -110</Para>
<Para Type="Programcode">            L0, -140</Para>
<Para Type="Programcode">            L15, -110</Para>
<Para Type="Programcode">            L5, -110</Para>
<Para Type="Programcode">            L20, -80</Para>
<Para Type="Programcode">            L10, -80</Para>
<Para Type="Programcode">            L25, -50</Para>
<Para Type="Programcode">            Z"</Para>
<Para Type="Programcode">        id="Canopy"/&#x003E;</Para>
<Para Type="Programcode">    &#x003C;linearGradient id="CanopyShadow" x=0 y=0 x2=0 y2=100%&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="0%" stop-color="#000" stop-opacity=".5" /&#x003E;</Para>
<Para Type="Programcode">        &#x003C;stop offset="20%" stop-color="#000" stop-opacity="0" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/linearGradient&#x003E;</Para>
<Para Type="Programcode">    &#x003C;g id="Tree"&#x003E;</Para>
<Para Type="Programcode">      &#x003C;use xlink:href="#Trunk" fill="url(#TrunkGradient)" /&#x003E;</Para>
<Para Type="Programcode">      &#x003C;use xlink:href="#Trunk" fill="url(#CanopyShadow)" /&#x003E;</Para>
<Para Type="Programcode">      &#x003C;use xlink:href="#Canopy" fill="none" stroke="#663300"</Para>
<Para Type="Programcode">         stroke-linejoin="round" stroke-width="4px" /&#x003E;</Para>
<Para Type="Programcode">      &#x003C;use xlink:href="#Canopy" fill="#339900" stroke="none" /&#x003E;</Para>
<Para Type="Programcode">    &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/defs&#x003E;</Para>
<Para Type="Programcode">  &#x003C;g transform="translate(-10, 350)"</Para>
<Para Type="Programcode">      stroke-width="20"</Para>
<Para Type="Programcode">      stroke="url(#GravelPattern)"</Para>
<Para Type="Programcode">      stroke-linejoin="round"&#x003E;</Para>
<Para Type="Programcode">        &#x003C;path d="M0,0 Q170,-50 260, -190 Q310, -250 410,-250"</Para>
<Para Type="Programcode">          fill="none" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/g&#x003E;</Para>
<Para Type="Programcode">  &#x003C;text y=60 x=200</Para>
<Para Type="Programcode">    font-family="impact"</Para>
<Para Type="Programcode">    font-size="60px"</Para>
<Para Type="Programcode">    fill="#996600"<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>trails-dynamic.html code</Tertiary></IndexTerm>
</Para>
<Para Type="Programcode">    text-anchor="middle" &#x003E;</Para>
<Para Type="Programcode">    Happy Trails!</Para>
<Para Type="Programcode">  &#x003C;/text&#x003E;</Para>
<Para Type="Programcode">  &#x003C;text y=90 x=200</Para>
<Para Type="Programcode">    font-family="impact"</Para>
<Para Type="Programcode">    font-size="20px"</Para>
<Para Type="Programcode">    fill="#996600"</Para>
<Para Type="Programcode">    text-anchor="middle" id="TreeCounter"&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/text&#x003E;</Para>
<Para Type="Programcode">  &#x003C;text y=420 x=20</Para>
<Para Type="Programcode">    font-family="impact"</Para>
<Para Type="Programcode">    font-size="20px"</Para>
<Para Type="Programcode">    fill="#996600"</Para>
<Para Type="Programcode">    text-anchor="left"&#x003E;</Para>
<Para Type="Programcode">    &#x003C;tspan&#x003E;You can remove a&#x003C;/tspan&#x003E;</Para>
<Para Type="Programcode">  &#x003C;tspan y=440 x=20&#x003E;tree by clicking on it.&#x003C;/tspan&#x003E;</Para>
<Para Type="Programcode">  &#x003C;/text&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#Tree" transform="translate(130,250)" /&#x003E;</Para>
<Para Type="Programcode">  &#x003C;use xlink:href="#Tree" transform="translate(260, 500) scale(2)" /&#x003E;</Para>
<Para Type="Programcode">&#x003C;/svg&#x003E;</Para>
<Para Type="Programcode">&#x003C;script&#x003E;</Para>
<Para Type="Programcode">  function removeTree(e) {</Para>
<Para Type="Programcode">    var elt = e.target;</Para>
<Para Type="Programcode">    if (elt.correspondingUseElement) {</Para>
<Para Type="Programcode">      elt = elt.correspondingUseElement;</Para>
<Para Type="Programcode">    }</Para>
<Para Type="Programcode">    elt.parentNode.removeChild(elt);</Para>
<Para Type="Programcode">    updateTrees();</Para>
<Para Type="Programcode">  }</Para>
<Para Type="Programcode">  document.getElementById("AddTreeButton").onclick = function() {</Para>
<Para Type="Programcode">    var x = Math.floor(Math.random() * 400);</Para>
<Para Type="Programcode">    var y = Math.floor(Math.random() * 600);</Para>
<Para Type="Programcode">    var scale = Math.random() + .5;</Para>
<Para Type="Programcode">    var translate = "translate(" + x + "," + y + ") ";</Para>
<Para Type="Programcode">    var tree = document.createElementNS("http://www.w3.org/2000/svg", "use");</Para>
<Para Type="Programcode">    tree.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", "#Tree");</Para>
<Para Type="Programcode">    tree.setAttribute("transform", translate + "scale(" + scale + ")");</Para>
<Para Type="Programcode">    document.querySelector("svg").appendChild(tree);</Para>
<Para Type="Programcode">    updateTrees();</Para>
<Para Type="Programcode">  }<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>interactive application</Secondary><Tertiary>trails-dynamic.html code</Tertiary></IndexTerm>
</Para>
<Para Type="Programcode">  function updateTrees() {</Para>
<Para Type="Programcode">    var list = document.querySelectorAll("use");</Para>
<Para Type="Programcode">    var treeCount = 0;</Para>
<Para Type="Programcode">    for (var i=0; i&#x003C;list.length; i++) {</Para>
<Para Type="Programcode">      if(list[i].getAttribute("xlink:href")=="#Tree") {</Para>
<Para Type="Programcode">        treeCount++;</Para>
<Para Type="Programcode">        list[i].onclick = removeTree;</Para>
<Para Type="Programcode">      }</Para>
<Para Type="Programcode">    }</Para>
<Para Type="Programcode">    var counter = document.getElementById("TreeCounter");</Para>
<Para Type="Programcode">    counter.textContent = treeCount + " trees in the forest";</Para>
<Para Type="Programcode">  }</Para>
<Para Type="Programcode">  updateTrees();</Para>
<Para Type="Programcode">&#x003C;/script&#x003E;</Para>
<FormalPara RenderingStyle="Style1">
<Heading>SVG TOOLS</Heading>
<Para><Emphasis Type="Bold">Frank says</Emphasis>:</Para>
<Para>&#x201C;Because of SVG&#x2019;s long history as a standard format for vector graphics, there are many useful tools<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>tools</Secondary></IndexTerm> for working with SVG images. There is even an open-source editor called SVG-edit that runs in the browser. You can embed it in your own applications! On the desktop, Adobe Illustrator and Inkscape are two powerful vector graphics applications that can both import and export SVG. I&#x2019;ve found Inkscape to be very useful for <IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>new file creation</Secondary></IndexTerm>creating new graphics (see Figure <InternalRef RefID="Fig13_3">3-13</InternalRef>).<Figure ID="Fig13_3" Float="Yes" Category="Standard">
<Caption Language="En">
<CaptionNumber>Figure 3-13</CaptionNumber>
<CaptionContent>
<SimplePara>Modifying the stroke of a text element in<IndexTerm><Primary>Scalable vector graphics (SVG)</Primary><Secondary>new file creation</Secondary></IndexTerm> Inkscape<IndexTerm><Primary>Inkscape</Primary></IndexTerm>
</SimplePara>
</CaptionContent>
</Caption>
<MediaObject ID="MO13_3">
<ImageObject FileRef="978-1-4302-3865-2_3_Fig13_HTML.gif" Format="GIF" Color="Color" Type="Linedraw" Rendition="HTML"/>
</MediaObject>
</Figure>
</Para>
<Para>SVG tools tend to work with standalone .svg files, not SVG embedded in HTML, so you may need to convert between the two formats.&#x201D;</Para>
</FormalPara>
</Section2>
<Section2 ID="Sec18_3">
<Heading>Summary</Heading>
<Para>In this chapter, you have seen how SVG in HTML5 provides a powerful way to create applications with interactive two dimensional graphics.</Para>
<Para>First we looked at a scene drawn using SVG embedded in an HTML5 document. We examined the elements and attributes that made up the drawing. We saw how you can define and reuse content definitions, group and transform elements, and draw with shapes, paths, and text.</Para>
<Para>Finally, we added JavaScript to an SVG document to make an interactive application. We used CSS, DOM manipulation, and events to take advantage of SVG&#x2019;s nature as a live document.</Para>
<Para>Now that we&#x2019;ve seen how SVG brings vector graphics to HTML5, we&#x2019;ll turn our attention to the communication features that can connect your web app to the outside world.</Para>
</Section2>
</Section1>
</Body>
<BodyRef FileRef="978-1-4302-3865-2_3_Chapter_OnlinePDF.pdf" TargetType="OnlinePDF" PDFType="Typeset" OutputMedium="Online"/>
</Chapter>